!function(t){"use strict";function e(t){let e=window.location.href;t=t.replace(/[\[\]]/g,"\\$&");let o=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);return o?o[2]?decodeURIComponent(o[2].replace(/\+/g," ")):"":null}function o(){t(".funnel-trigger-group .funnel_block_item_condition").each((function(){var e=t(this),o=e.find(".add_condition_inside_node_point.condition_false"),i=e.find(".add_condition_inside_node_point.condition_true"),a=e.find(".end_condition_wrapper"),n=o.length>0?o.outerHeight(!0):0,s=i.length>0?i.outerHeight(!0):0,d=Math.max(n,s),l=`calc(1rem + ${d}px)`,r=`calc(${d}px - 100px)`;e.css("height",l),a.css("height",r)}))}jQuery(document).ready((function(t){setTimeout((function(){t(".joinotify-triggers-tab-wrapper a.nav-tab").first().click()}),500),t(document).on("click",".joinotify-triggers-tab-wrapper a.nav-tab",(function(){let e=t(this).attr("href");t(".joinotify-triggers-tab-wrapper a.nav-tab").removeClass("nav-tab-active"),t(".triggers-content-wrapper .nav-content").removeClass("active"),t(this).addClass("nav-tab-active"),t(".triggers-content-wrapper").find(e).addClass("active")}))})),jQuery(document).ready((function(t){function e(e,o){if(e){var i=e.name,a=t(".woo-custom-installments-wrapper"),n=new FormData;n.append("action","wci_alternative_activation_license"),n.append("file",e),o.children(".file-list").removeClass("d-none").text(i),o.addClass("file-processing"),o.append('<div class="spinner-border"></div>'),t.ajax({url:wci_params.ajax_url,type:"POST",data:n,processData:!1,contentType:!1,success:function(e){joinotify_builder_params.debug_mode&&console.log(e);try{"success"===e.status?(a.before(`<div id="toast_success_alternative_license" class="toast toast-success show">\n\t\t\t\t\t\t\t\t\t<div class="toast-header bg-success text-white">\n\t\t\t\t\t\t\t\t\t\t<svg class="woo-custom-installments-toast-check-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#ffffff"><g stroke-width="0"/><g stroke-linecap="round" stroke-linejoin="round"/><g><path d="M10.5 15.25C10.307 15.2353 10.1276 15.1455 9.99998 15L6.99998 12C6.93314 11.8601 6.91133 11.7029 6.93756 11.55C6.96379 11.3971 7.03676 11.2562 7.14643 11.1465C7.2561 11.0368 7.39707 10.9638 7.54993 10.9376C7.70279 10.9114 7.86003 10.9332 7.99998 11L10.47 13.47L19 5.00004C19.1399 4.9332 19.2972 4.91139 19.45 4.93762C19.6029 4.96385 19.7439 5.03682 19.8535 5.14649C19.9632 5.25616 20.0362 5.39713 20.0624 5.54999C20.0886 5.70286 20.0668 5.86009 20 6.00004L11 15C10.8724 15.1455 10.6929 15.2353 10.5 15.25Z" fill="#ffffff"/> <path d="M12 21C10.3915 20.9974 8.813 20.5638 7.42891 19.7443C6.04481 18.9247 4.90566 17.7492 4.12999 16.34C3.54037 15.29 3.17596 14.1287 3.05999 12.93C2.87697 11.1721 3.2156 9.39921 4.03363 7.83249C4.85167 6.26578 6.1129 4.9746 7.65999 4.12003C8.71001 3.53041 9.87134 3.166 11.07 3.05003C12.2641 2.92157 13.4719 3.03725 14.62 3.39003C14.7224 3.4105 14.8195 3.45215 14.9049 3.51232C14.9903 3.57248 15.0622 3.64983 15.116 3.73941C15.1698 3.82898 15.2043 3.92881 15.2173 4.03249C15.2302 4.13616 15.2214 4.2414 15.1913 4.34146C15.1612 4.44152 15.1105 4.53419 15.0425 4.61352C14.9745 4.69286 14.8907 4.75712 14.7965 4.80217C14.7022 4.84723 14.5995 4.87209 14.4951 4.87516C14.3907 4.87824 14.2867 4.85946 14.19 4.82003C13.2186 4.52795 12.1987 4.43275 11.19 4.54003C10.193 4.64212 9.22694 4.94485 8.34999 5.43003C7.50512 5.89613 6.75813 6.52088 6.14999 7.27003C5.52385 8.03319 5.05628 8.91361 4.77467 9.85974C4.49307 10.8059 4.40308 11.7987 4.50999 12.78C4.61208 13.777 4.91482 14.7431 5.39999 15.62C5.86609 16.4649 6.49084 17.2119 7.23999 17.82C8.00315 18.4462 8.88357 18.9137 9.8297 19.1953C10.7758 19.4769 11.7686 19.5669 12.75 19.46C13.747 19.3579 14.713 19.0552 15.59 18.57C16.4349 18.1039 17.1818 17.4792 17.79 16.73C18.4161 15.9669 18.8837 15.0864 19.1653 14.1403C19.4469 13.1942 19.5369 12.2014 19.43 11.22C19.4201 11.1169 19.4307 11.0129 19.461 10.9139C19.4914 10.8149 19.5409 10.7228 19.6069 10.643C19.6728 10.5631 19.7538 10.497 19.8453 10.4485C19.9368 10.3999 20.0369 10.3699 20.14 10.36C20.2431 10.3502 20.3471 10.3607 20.4461 10.3911C20.5451 10.4214 20.6372 10.471 20.717 10.5369C20.7969 10.6028 20.863 10.6839 20.9115 10.7753C20.9601 10.8668 20.9901 10.9669 21 11.07C21.1821 12.829 20.842 14.6026 20.0221 16.1695C19.2022 17.7363 17.9389 19.0269 16.39 19.88C15.3288 20.4938 14.1495 20.8755 12.93 21C12.62 21 12.3 21 12 21Z" fill="#ffffff"/></g></svg>\n\t\t\t\t\t\t\t\t\t\t<span class="me-auto">${e.toast_header}</span>\n\t\t\t\t\t\t\t\t\t\t<button class="btn-close btn-close-white ms-2 hide-toast" type="button" data-bs-dismiss="toast" aria-label="Close"></button>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="toast-body">${e.toast_body}</div>\n\t\t\t\t\t\t\t\t</div>`),setTimeout((function(){t("#toast_success_alternative_license").fadeOut("fast")}),3e3),setTimeout((function(){t("#toast_success_alternative_license").remove()}),3500),o.addClass("file-uploaded").removeClass("file-processing"),o.children(".spinner-border").remove(),o.append('<div class="upload-notice d-flex flex-column align-items-center"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="#22c55e" d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"></path><path fill="#22c55e" d="M9.999 13.587 7.7 11.292l-1.412 1.416 3.713 3.705 6.706-6.706-1.414-1.414z"></path></svg><span>'+e.dropfile_message+"</span></div>"),o.children(".file-list").addClass("d-none"),setTimeout((function(){location.reload()}),1e3)):(a.before(`<div id="toast_danger_alternative_license" class="toast toast-danger show">\n\t\t\t\t\t\t\t\t\t<div class="toast-header bg-danger text-white">\n\t\t\t\t\t\t\t\t\t\t<svg class="icon icon-white me-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"></path><path d="M11 11h2v6h-2zm0-4h2v2h-2z"></path></svg>\n\t\t\t\t\t\t\t\t\t\t<span class="me-auto">${e.toast_header}</span>\n\t\t\t\t\t\t\t\t\t\t<button class="btn-close btn-close-white ms-2 hide-toast" type="button" data-bs-dismiss="toast" aria-label="Close"></button>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="toast-body">${e.toast_body}</div>\n\t\t\t\t\t\t\t\t</div>`),setTimeout((function(){t("#toast_danger_alternative_license").fadeOut("fast")}),3e3),setTimeout((function(){t("#toast_danger_alternative_license").remove()}),3500),o.addClass("invalid-file").removeClass("file-processing"),o.children(".spinner-border").remove(),o.children(".drag-text").removeClass("d-none"),o.children(".drag-and-drop-file").removeClass("d-none"),o.children(".upload-license-key").removeClass("d-none"),o.children(".file-list").addClass("d-none"))}catch(t){console.log(t)}},error:function(t,e,i){o.addClass("fail-upload").removeClass("file-processing"),console.log("Error on upload file"),console.log(t.responseText)}})}}t("#joinotify_import_file_zone").on("dragover dragleave",(function(e){e.preventDefault(),t(this).toggleClass("drag-over","dragover"===e.type)})),t("#joinotify_import_file_zone").on("drop",(function(o){o.preventDefault();var i=o.originalEvent.dataTransfer.files[0];t(this).hasClass("file-uploaded")||e(i,t(this))})),t("#upload_template_file").on("change",(function(o){e(o.target.files[0],t(this).parents(".dropzone-license"))}))})),jQuery(document).ready((function(){[...document.querySelectorAll('[data-bs-toggle="tooltip"]')].map((t=>new bootstrap.Tooltip(t)))})),jQuery(document).ready((function(t){t(document).on("click",'button[data-bs-toggle="modal"], a[data-bs-toggle="modal"]',(function(e){e.preventDefault();let o=t(this).attr("data-bs-target"),i=t(o).detach();t("#wpcontent").prepend(i);[...document.querySelectorAll('[data-bs-toggle="tooltip"]')].map((t=>new bootstrap.Tooltip(t)))}))})),jQuery(document).ready((function(t){e("id")||t.ajax({url:joinotify_builder_params.ajax_url,method:"POST",data:{action:"joinotify_get_templates_count",template:"template"},success:function(e){if(joinotify_builder_params.debug_mode&&console.log(e),"success"===e.status){var o=e.template_count,i=t(".joinotify-templates-group");i.empty();for(var a=0;a<o;a++)i.append('<div class="template-item placeholder-content"></div>');t("#joinotify_template_library_container").addClass("templates-counted")}else display_toast("error",e.toast_header_title,e.toast_body_title,t("#joinotify-automations-builder"))},error:function(t,e,o){console.error("AJAX Error:",o)}}),t(document).on("click",".choose-template",(function(e){e.preventDefault();var o=t(this),i=o.width(),a=o.height(),n=o.html(),s=o.data("template");o.width(i),o.height(a),o.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>'),setTimeout((function(){o.prop("disabled",!1).html(n)}),1e3),"scratch"===s?setTimeout((function(){t("#joinotify_start_choose_container").removeClass("active"),t("#joinotify_choose_template_container").removeClass("active"),t("#joinotify_triggers_group").addClass("active"),t("#joinotify_triggers_content").addClass("active"),t("#joinotify_builder_navbar").addClass("active")}),1e3):"template"===s?(setTimeout((function(){t("#joinotify_start_choose_container").removeClass("active slide-left-animation").addClass("slide-right-animation"),t("#joinotify_template_library_container").addClass("active slide-left-animation").removeClass("slide-right-animation")}),1e3),t.ajax({url:joinotify_builder_params.ajax_url,method:"POST",data:{action:"joinotify_get_workflow_templates",template:s},success:function(e){joinotify_builder_params.debug_mode&&console.log(e);try{"success"===e.status?(t(".joinotify-templates-group").html(e.template_html),t("#joinotify_template_library_container").addClass("templates-loaded").removeClass("templates-counted")):display_toast("error",e.toast_header_title,e.toast_body_title,t("#joinotify-automations-builder"))}catch(t){console.log(t)}}})):"import"===s&&setTimeout((function(){t("#joinotify_start_choose_container").removeClass("active slide-left-animation").addClass("slide-right-animation"),t("#joinotify_import_template_container").addClass("active slide-left-animation").removeClass("slide-right-animation")}),1e3)}))})),jQuery(document).ready((function(t){t(".joinotify-trigger-details").each((function(){t(this).detach().insertAfter("#wpadminbar")})),null===e("id")&&t(".joinotify-loader-container").addClass("d-none")})),jQuery(document).ready((function(t){t(document).on("click","#joinotify_proceed_step_funnel",(function(i){i.preventDefault();var a=t(this),n=a.width(),s=a.height(),d=a.html(),l=t("#joinotify_set_workflow_name").val(),r=e("id");a.width(n),a.height(s),t.ajax({url:joinotify_builder_params.ajax_url,method:"POST",data:{action:"joinotify_create_workflow",title:l,context:t(".trigger-item.active").data("context"),trigger:t(".trigger-item.active").data("trigger"),post_id:r},beforeSend:function(){a.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(e){joinotify_builder_params.debug_mode&&console.log(e);try{"success"===e.status&&!0===e.proceed?(r?t("#joinotify_workflow_status").replaceWith(e.workflow_status):(o="id",i=e.post_id,(a=new URL(window.location.href)).searchParams.set(o,i),window.history.pushState({},"",a),r=e.post_id,t("#joinotify_workflow_header_title_container").append(e.workflow_status)),t("#offcanvas_condition").find(".offcanvas-body").html(e.condition_selectors),t("#joinotify_actions_wrapper").html(e.sidebar_actions),t("#offcanvas_send_whatsapp_message_text").find(".offcanvas-body").append(e.fetch_groups_trigger),t("#offcanvas_send_whatsapp_message_text").find(".offcanvas-body").append(e.placeholders_list),t("#offcanvas_send_whatsapp_message_media").find(".offcanvas-body").append(e.fetch_groups_trigger),t("#send_whatsapp_message_media").find(".offcanvas-body").append(e.placeholders_list),t("#add_action_condition").prop("disabled",!0),t("#joinotify_triggers_group").removeClass("active"),t("#joinotify_triggers_content").removeClass("active"),t("#joinotify_workflow_status_switch").prop("disabled",!1),t("#joinotify_workflow_title").text(l),document.title=l,t("#joinotify_builder_funnel").children(".funnel-trigger-group").html(e.workflow_content),t(document).trigger("workflowReady"),display_toast("success",e.toast_header_title,e.toast_body_title,t("#joinotify-automations-builder"))):display_toast("error",e.toast_header_title,e.toast_body_title,t("#joinotify-automations-builder"))}catch(t){console.log(t)}var o,i,a},complete:function(){a.prop("disabled",!1).html(d),o()}})}))})),jQuery(document).ready((function(t){var i=!1,a="",n="";function s(){let e=t("#joinotify_set_workflow_name").val(),o=t(".trigger-item.active").data("trigger"),i=t("#joinotify_proceed_step_funnel");""!==e&&o?i.prop("disabled",!1):i.prop("disabled",!0)}t("#joinotify_set_workflow_name").val(joinotify_builder_params.default_workflow_name),t(document).on("change input","#joinotify_set_workflow_name",(function(){s()})),t(document).on("click",".trigger-item",(function(){t(".trigger-item").removeClass("active"),t(this).toggleClass("active"),s()})),t(document).on("click",".funnel_add_action",(function(){let e=t("#joinotify_actions_group"),o=t(this);a=o.data("condition"),"condition"===o.data("action")?(e.hasClass("active")||(e.addClass("active"),t("#joinotify_builder_funnel").addClass("waiting-select-action"),t(".funnel_add_action").children(".plusminus").addClass("active")),i=!0,n=o.data("action-id"),t(".joinotify_condition_node_point").removeClass("active"),o.parent(".add_condition_inside_node_point").parent(".joinotify_condition_node_point").addClass("active"),t('.action-item[data-action="time_delay"]').addClass("locked"),t('.action-item[data-action="condition"]').addClass("locked")):(e.toggleClass("active"),i=!1,n="",t(".joinotify_condition_node_point").removeClass("active"),t('.action-item[data-action="time_delay"]').removeClass("locked"),t('.action-item[data-action="condition"]').removeClass("locked"),e.hasClass("active")?(t("#joinotify_builder_funnel").addClass("waiting-select-action"),t(".funnel_add_action").children(".plusminus").addClass("active")):(t("#joinotify_builder_funnel").removeClass("waiting-select-action"),t(".funnel_add_action").children(".plusminus").removeClass("active"),t(".joinotify_condition_node_point").removeClass("active"),i=!1,t(".action-item.locked").removeClass("locked")))})),t(document).on("click","#joinotify_close_actions_group",(function(e){e.preventDefault();let o=t("#joinotify_actions_group");o.removeClass("active"),t(".joinotify_condition_node_point").removeClass("active"),t(".plusminus.active").removeClass("active"),o.hasClass("active")?t("#joinotify_builder_funnel").addClass("waiting-select-action"):(t("#joinotify_builder_funnel").removeClass("waiting-select-action"),i=!1,t(".action-item.locked").removeClass("locked"))})),t(document).on("click",".expand-offcanvas",(function(e){e.preventDefault(),t(this).addClass("d-none"),t(this).siblings(".collapse-offcanvas").removeClass("d-none"),t(".offcanvas.show").addClass("offcanvas-expanded"),t("#joinotify_builder_funnel").addClass("offcanvas-expanded")})),t(document).on("click",'.btn-close[data-bs-dismiss="offcanvas"], .collapse-offcanvas',(function(){t(this).siblings(".expand-offcanvas").removeClass("d-none"),t(this).siblings(".collapse-offcanvas").addClass("d-none"),t(this).closest(".collapse-offcanvas").addClass("d-none"),t(".offcanvas.offcanvas-expanded").removeClass("offcanvas-expanded"),t("#joinotify_builder_funnel").removeClass("offcanvas-expanded")})),t(document).on("click",".condition-item",(function(){var e=t(this).data("condition");t(".condition-item").removeClass("active"),t(".condition-settings-item").removeClass("active"),t(this).toggleClass("active"),t('.condition-settings-item[data-condition="'+e+'"]').addClass("active"),t(".condition-item").hasClass("active")?t("#add_action_condition").prop("disabled",!1):t("#add_action_condition").prop("disabled",!0)})),t(document).on("click",".add-funnel-action",(function(s){s.preventDefault();var d=t(this),l=d.width(),r=d.height(),c=d.html();d.width(l),d.height(r);var _=e("id"),f=t(".offcanvas.show").data("action"),u={};if("time_delay"===f){var p=t(".set-time-delay-type").val();u={type:"action",data:{action:"time_delay",title:t(".offcanvas.show").find(".offcanvas-title").text(),delay_type:p}},"period"===p?(u.data.delay_value=t(".get-wait-value").val(),u.data.delay_period=t(".get-wait-period").val()):"date"===p&&(u.data.date_value=t(".get-date-value").val(),u.data.time_value=t(".get-time-value").val())}else"send_whatsapp_message_text"===f?u={type:"action",data:{action:"send_whatsapp_message_text",title:t(".offcanvas.show").find(".offcanvas-title").text(),sender:t("#joinotify_get_whatsapp_phone_sender").val(),receiver:t("#joinotify_get_whatsapp_number_msg_text").val(),message:t("#joinotify_get_whatsapp_message_text").val()}}:"send_whatsapp_message_media"===f?u={type:"action",data:{action:"send_whatsapp_message_media",title:t(".offcanvas.show").find(".offcanvas-title").text(),sender:t("#joinotify_get_whatsapp_phone_sender_media").val(),receiver:t("#joinotify_get_whatsapp_number_msg_media").val(),media_type:t("#joinotify_get_media_type").val(),media_url:t("#joinotify_get_url_media").val()}}:"condition"===f?u={type:"action",data:{action:"condition",condition:t(".condition-item.active").data("condition"),title:t(".condition-item.active").find(".title").text(),condition_content:{condition:t(".condition-settings-item.active").data("condition"),type:t(".condition-settings-item.active").find(".get-condition-type option:selected").val(),type_text:t(".condition-settings-item.active").find(".get-condition-type option:selected").text(),value:t(".condition-settings-item.active").find(".get-condition-value option:selected").val()||t(".condition-settings-item.active").find(".get-condition-value").val(),value_text:t(".condition-settings-item.active").find(".get-condition-value option:selected").text()||t(".condition-settings-item.active").find(".get-condition-value").val()}}}:"stop_funnel"===f&&(u={type:"action",data:{action:"stop_funnel"}});joinotify_builder_params.debug_mode&&(console.log(u),console.log("Post ID: ",_)),t.ajax({url:joinotify_builder_params.ajax_url,method:"POST",data:{action:"joinotify_add_workflow_action",post_id:_,action_condition:i,action_id:n,condition_action:a,workflow_action:JSON.stringify(u)},beforeSend:function(){d.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(e){joinotify_builder_params.debug_mode&&console.log(e);try{"success"===e.status?(t(".offcanvas.show").removeClass("show"),t(".set-time-delay-type option:first").attr("selected","selected"),t(".get-wait-value").val(""),t(".get-wait-period option:first").attr("selected","selected"),t(".get-date-value").val(""),t(".get-time-value").val(""),t("#joinotify_get_whatsapp_message_text").val("").change(),t("#joinotify_get_url_media").val(""),t(".condition-item.active").removeClass("active"),t(".condition-settings-item.active").removeClass("active"),t(".joinotify_condition_node_point").removeClass("active"),t(".get-condition-type").each((function(){t(this).find("option:first").attr("selected","selected")})),t(".get-condition-value").each((function(){t(this).find("option:first").attr("selected","selected")||t(this).val("")})),e.has_action?t("#joinotify_builder_run_test").prop("disabled",!1):t("#joinotify_builder_run_test").prop("disabled",!0),t("#joinotify_builder_funnel").children(".funnel-trigger-group").html(e.workflow_content),t(document).trigger("workflowReady"),display_toast("success",e.toast_header_title,e.toast_body_title,t("#joinotify-automations-builder"))):display_toast("error",e.toast_header_title,e.toast_body_title,t("#joinotify-automations-builder"))}catch(t){console.log(t)}},complete:function(){o(),d.prop("disabled",!1).html(c),t("#joinotify_actions_group").removeClass("active"),t(".condition-item.active").removeClass("active"),t("#add_action_condition").prop("disabled",!0),t("#joinotify_builder_funnel").removeClass("waiting-select-action")}})}))})),jQuery(document).ready((function(t){t(document).on("click",".exclude-trigger",(function(o){if(o.preventDefault(),confirm(joinotify_builder_params.confirm_exclude_trigger)){var i=t(this);t.ajax({url:joinotify_builder_params.ajax_url,method:"POST",data:{action:"joinotify_delete_trigger",post_id:e("id"),trigger_id:i.data("trigger-id")},beforeSend:function(){i.prop("disabled",!0),i.closest(".funnel-trigger-item").addClass("placeholder-wave removing-trigger")},success:function(e){joinotify_builder_params.debug_mode&&console.log(e);try{"success"===e.status?(e.has_trigger?t("#joinotify_builder_run_test").prop("disabled",!1):(t("#joinotify_triggers_group").addClass("active"),t("#joinotify_triggers_content").addClass("active"),t("#joinotify_builder_run_test").prop("disabled",!0),setTimeout((function(){t(".trigger-item").removeClass("active"),t(".joinotify-triggers-tab-wrapper a.nav-tab").first().click()}),500)),t("#joinotify_builder_funnel").children(".funnel-trigger-group").html(e.workflow_content),t(document).trigger("workflowReady"),display_toast("success",e.toast_header_title,e.toast_body_title,t("#joinotify-automations-builder"))):display_toast("error",e.toast_header_title,e.toast_body_title,t("#joinotify-automations-builder"))}catch(t){console.log(t)}},complete:function(){i.prop("disabled",!1),i.closest(".funnel-trigger-item").removeClass("placeholder-wave removing-trigger")}})}}))})),jQuery(document).ready((function(t){t(document).on("click",".exclude-action",(function(i){if(i.preventDefault(),confirm(joinotify_builder_params.confirm_exclude_action)){var a=t(this);t.ajax({url:joinotify_builder_params.ajax_url,method:"POST",data:{action:"joinotify_delete_workflow_action",post_id:e("id"),action_id:a.data("action-id")},beforeSend:function(){a.prop("disabled",!0),a.closest(".funnel-action-item").addClass("placeholder-wave removing-action")},success:function(e){joinotify_builder_params.debug_mode&&console.log(e);try{"success"===e.status?(e.has_action?t("#joinotify_builder_run_test").prop("disabled",!1):t("#joinotify_builder_run_test").prop("disabled",!0),t("#joinotify_builder_funnel").children(".funnel-trigger-group").html(e.workflow_content),t(document).trigger("workflowReady"),display_toast("success",e.toast_header_title,e.toast_body_title,t("#joinotify-automations-builder"))):display_toast("error",e.toast_header_title,e.toast_body_title,t("#joinotify-automations-builder"))}catch(t){console.log(t)}},complete:function(){a.prop("disabled",!1),a.closest(".funnel-action-item").removeClass("placeholder-wave removing-action"),o()}})}}))})),jQuery(document).ready((function(t){t(document).on("click","#joinotify_workflow_status_switch",(function(){var o=t(this);t.ajax({url:joinotify_builder_params.ajax_url,method:"POST",data:{action:"joinotify_update_workflow_status",status:o.prop("checked")?"publish":"draft",post_id:e("id")},beforeSend:function(){o.prop("disabled",!0)},complete:function(){o.prop("disabled",!1)},success:function(e){joinotify_builder_params.debug_mode&&console.log(e);try{"success"===e.status?(t("#joinotify_workflow_status_title").text(e.workflow_status),t("#joinotify_workflow_status").replaceWith(e.display_workflow_status),display_toast("success",e.toast_header_title,e.toast_body_title,t("#joinotify-automations-builder"))):display_toast("error",e.toast_header_title,e.toast_body_title,t("#joinotify-automations-builder"))}catch(t){console.log(t)}}})}))})),jQuery(document).ready((function(t){var i=e("id");i&&t.ajax({url:joinotify_builder_params.ajax_url,type:"POST",data:{action:"joinotify_load_workflow_data",post_id:i},beforeSend:function(){t(".joinotify-loader-container").removeClass("d-none")},success:function(e){joinotify_builder_params.debug_mode&&console.log(e);try{"success"===e.status?(t("#joinotify_choose_template_container").removeClass("active"),t("#joinotify_builder_navbar").addClass("active"),e.has_trigger?(t("#joinotify_triggers_group").removeClass("active"),t("#joinotify_triggers_content").removeClass("active")):(t("#joinotify_triggers_group").addClass("active"),t("#joinotify_triggers_content").addClass("active")),e.has_action?t("#joinotify_builder_run_test").prop("disabled",!1):t("#joinotify_builder_run_test").prop("disabled",!0),t("#offcanvas_condition").find(".offcanvas-body").html(e.condition_selectors),t("#joinotify_actions_wrapper").html(e.sidebar_actions),t("#offcanvas_send_whatsapp_message_text").find(".offcanvas-body").append(e.fetch_groups_trigger),t("#offcanvas_send_whatsapp_message_text").find(".offcanvas-body").append(e.placeholders_list),t("#offcanvas_send_whatsapp_message_media").find(".offcanvas-body").append(e.fetch_groups_trigger),t("#send_whatsapp_message_media").find(".offcanvas-body").append(e.placeholders_list),t("#add_action_condition").prop("disabled",!0),t("#joinotify_workflow_title").text(e.workflow_title),t("#joinotify_edit_workflow_title").val(e.workflow_title),t("#joinotify_set_workflow_name").val(e.workflow_title),document.title=e.workflow_title,t("#joinotify_workflow_header_title_container").append(e.display_workflow_status),t("#joinotify_builder_funnel .funnel-trigger-group").prepend(e.workflow_data),t("#joinotify_workflow_status_switch").prop("disabled",!1),"publish"===e.workflow_status&&(t("#joinotify_workflow_status_switch").prop("checked",!0),t("#joinotify_workflow_status_title").text(joinotify_builder_params.status_active)),t("#joinotify_builder_funnel").children(".funnel-trigger-group").html(e.workflow_content),t(document).trigger("workflowReady"),t(".funnel-trigger-item").length>0&&t(".funnel-trigger-item").each((function(){var e=t(this).data("context"),o=t(this).data("trigger"),i=t('.trigger-item[data-context="'+e+'"][data-trigger="'+o+'"]');i.length>0&&i.addClass("active")}))):display_toast("error",e.toast_header_title,e.toast_body_title,t("#joinotify-automations-builder"))}catch(t){console.log(t)}},complete:function(){t(".joinotify-loader-container").addClass("d-none"),o()},error:function(t,e,o){console.error("Error on AJAX request:",t.responseText)}})})),jQuery(document).ready((function(t){t(document).on("click","#joinotify_update_workflow_title",(function(o){o.preventDefault();var i=t(this),a=i.width(),n=i.height(),s=i.html();i.width(a),i.height(n),t.ajax({url:joinotify_builder_params.ajax_url,method:"POST",data:{action:"joinotify_update_workflow_title",post_id:e("id"),workflow_title:t("#joinotify_edit_workflow_title").val()},beforeSend:function(){i.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(e){joinotify_builder_params.debug_mode&&console.log(e);try{"success"===e.status?(t("#joinotify_workflow_title").text(e.workflow_title),t("#joinotify_edit_workflow_title").val(e.workflow_title),t("#joinotify_set_workflow_name").val(e.workflow_title),document.title=e.workflow_title,t("#edit_workflow_title").find(".btn-close").click(),display_toast("success",e.toast_header_title,e.toast_body_title,t("#joinotify-automations-builder"))):(t("#edit_workflow_title").find(".btn-close").click(),t("#joinotify_edit_workflow_title").val(""),display_toast("error",e.toast_header_title,e.toast_body_title,t("#joinotify-automations-builder")))}catch(t){console.log(t)}},complete:function(){i.prop("disabled",!1).html(s)}})}))})),jQuery(document).on("workflowReady",(function(){t(document).on("change",".set-time-delay-type",(function(){var e=t(this),o=e.val();e.parent("div").siblings(".wait-time-period-container").toggleClass("d-none","period"!==o),e.parent("div").siblings(".wait-date-container").toggleClass("d-none","date"!==o)})),t(".set-time-delay-type").each((function(){var e=t(this),o=e.val();e.parent("div").siblings(".wait-time-period-container").toggleClass("d-none","period"!==o),e.parent("div").siblings(".wait-date-container").toggleClass("d-none","date"!==o)}))})),jQuery(document).ready((function(t){t(".dateselect").datepicker({format:"dd/mm/yyyy",todayHighlight:!0,language:"pt-BR"}),t(document).on("focus",".dateselect",(function(){t(this).data("datepicker")||t(this).datepicker({format:"dd/mm/yyyy",todayHighlight:!0,language:"pt-BR"})}))})),jQuery(document).ready((function(t){t(document).on("input change blur",".set-whatsapp-message-text",(function(){var e=t(this).val(),o=t(this).closest(".input-group").siblings(".preview-whatsapp-message-sender");""!==(e=(e=e.replace(/\n/g,"<br>")).replace(/{{ br }}/g,"<br>")).trim()?o.addClass("active").html(e):o.removeClass("active").html("")}))})),jQuery(document).ready((function(t){t("#joinotify_export_workflow").on("click",(function(o){o.preventDefault();var i=e("id");t.ajax({url:joinotify_builder_params.ajax_url,method:"POST",data:{action:"joinotify_export_workflow",post_id:i,security:joinotify_builder_params.export_nonce},dataType:"json",beforeSend:function(){t(".joinotify-loader-container").removeClass("d-none").addClass("exporting-workflow")},complete:function(){t(".joinotify-loader-container").addClass("d-none").removeClass("exporting-workflow")},success:function(e){try{if("success"===e.status){var o="joinotify-workflow-"+i+".json";!function(t,e,o){var i=new Blob([t],{type:o}),a=document.createElement("a"),n=URL.createObjectURL(i);a.href=n,a.download=e,document.body.appendChild(a),a.click(),setTimeout((function(){document.body.removeChild(a),window.URL.revokeObjectURL(n)}),0)}(JSON.stringify(e.export_data,null,2),o,"application/json"),display_toast("success",e.toast_header_title,e.toast_body_title,t("#joinotify-automations-builder"))}else display_toast("error",e.toast_header_title,e.toast_body_title,t("#joinotify-automations-builder"))}catch(t){console.log(t)}},error:function(t,e,o){alert("AJAX error: "+o)}})}))})),jQuery(document).ready((function(t){t(document).on("click",".return-to-start",(function(e){e.preventDefault(),t("#joinotify_triggers_group").removeClass("active"),t("#joinotify_triggers_content").removeClass("active"),t("#joinotify_builder_navbar").removeClass("active"),t("#joinotify_choose_template_container").addClass("active"),t("#joinotify_start_choose_container").addClass("active")})),t(document).on("click","#joinotify_cancel_import_template",(function(e){e.preventDefault(),t("#joinotify_import_template_container").removeClass("active"),t("#joinotify_start_choose_container").addClass("active")}))})),jQuery(document).ready((function(t){var e;t("#joinotify_set_url_media").on("click",(function(o){o.preventDefault(),e||(e=wp.media.frames.file_frame=wp.media({title:joinotify_builder_params.set_media_title,button:{text:joinotify_builder_params.use_this_media_title},multiple:!1})).on("select",(function(){var o=e.state().get("selection").first().toJSON().url;t("#joinotify_get_url_media").val(o).trigger("change")})),e.open()}))})),jQuery(document).ready((function(t){t(document).on("click","#joinotify_builder_run_test",(function(o){o.preventDefault();var i=t(this),a=i.width(),n=i.height(),s=i.html();i.width(a),i.height(n),t.ajax({url:joinotify_builder_params.ajax_url,method:"POST",data:{action:"joinotify_run_workflow_test",post_id:e("id")},beforeSend:function(){i.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(e){joinotify_builder_params.debug_mode&&console.log(e);try{"success"===e.status?display_toast("success",e.toast_header_title,e.toast_body_title,t("#joinotify-automations-builder")):display_toast("error",e.toast_header_title,e.toast_body_title,t("#joinotify-automations-builder"))}catch(t){console.log(t)}},complete:function(){i.prop("disabled",!1).html(s)}})}))})),jQuery(document).ready((function(t){t(document).on("click","#joinotify_dismiss_placeholders_tip",(function(e){e.preventDefault(),t.ajax({url:joinotify_builder_params.ajax_url,method:"POST",data:{action:"joinotify_dismiss_placeholders_tip"},success:function(t){joinotify_builder_params.debug_mode&&console.log(t)},error:function(t){console.log(t)}})}))})),jQuery(document).ready((function(t){t(document).on("click","#joinotify_fetch_all_groups",(function(e){e.preventDefault(),t("#joinotify_fetch_all_groups_container").hasClass("content-loaded")||t.ajax({url:joinotify_builder_params.ajax_url,method:"POST",data:{action:"joinotify_fetch_all_groups",sender:t("#joinotify_get_whatsapp_phone_sender").val()},success:function(e){joinotify_builder_params.debug_mode&&console.log(e);try{"success"===e.status?t("#joinotify_fetch_all_groups_container").addClass("content-loaded").find(".modal-body").html(e.groups_details_html):(t("#joinotify_fetch_all_groups_container").find(".btn-close").click(),display_toast("error",e.toast_header_title,e.toast_body_title,t("#joinotify-automations-builder")))}catch(t){console.log(t)}},error:function(t){console.log(t)}})})),t(document).on("click",".get-group-id",(function(){var e=t(this),o=e.data("group-id");navigator.clipboard.writeText(o).then((function(){e.append(`<div class="confirm-copy-ui active">\n\t\t\t\t\t\t<svg class="icon icon-lg icon-white me-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"></path><path d="M9.999 13.587 7.7 11.292l-1.412 1.416 3.713 3.705 6.706-6.706-1.414-1.414z"></path></svg>\n\t\t\t\t\t\t<span>${joinotify_builder_params.copy_group_id}</span>\n\t\t\t\t</div>`),setTimeout((function(){e.find(".confirm-copy-ui").removeClass("active")}),800),setTimeout((function(){e.find(".confirm-copy-ui").remove()}),1e3)})).catch((function(t){console.error("Error on copy group ID: "+t)}))}))})),jQuery(document).ready((function(t){t(document).on("click",".save-action-edit",(function(o){o.preventDefault();var i=t(this),a=i.width(),n=i.height(),s=i.html(),d=i.data("action"),l=i.data("action-id");i.width(a),i.height(n);var r={};if("time_delay"===d){var c=t(".modal.show").find(".set-time-delay-type-edit").val();r={action:"time_delay",data:{delay_type:c}},"period"===c?(r.data.delay_value=t(".modal.show").find(".get-wait-value").val(),r.data.delay_period=t(".modal.show").find(".get-wait-period").val()):"date"===c&&(r.data.date_value=t(".modal.show").find(".get-date-value").val(),r.data.time_value=t(".modal.show").find(".get-time-value").val())}else"send_whatsapp_message_text"===d?r={action:"send_whatsapp_message_text",data:{sender:t(".modal.show").find(".get-phone-sender-edit").val(),receiver:t(".modal.show").find(".get-whatsapp-number-edit").val(),message:t(".modal.show").find(".edit-whatsapp-message-text").val()}}:"send_whatsapp_message_media"===d?r={action:"send_whatsapp_message_media",data:{sender:t(".modal.show").find(".get-phone-sender-edit").val(),receiver:t(".modal.show").find(".get-whatsapp-number-edit").val(),media_type:t(".modal.show").find(".get-media-type-edit").val(),media_url:t(".modal.show").find(".get-media-url-edit").val()}}:"condition"===d&&(r={data:{action:"condition"}});joinotify_builder_params.debug_mode&&console.log(r),t.ajax({url:joinotify_builder_params.ajax_url,method:"POST",data:{action:"joinotify_save_action_edition",post_id:e("id"),action_id:l,new_action_data:JSON.stringify(r)},beforeSend:function(){i.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(e){joinotify_builder_params.debug_mode&&console.log(e);try{"success"===e.status?(t("#joinotify_builder_funnel").children(".funnel-trigger-group").html(e.workflow_content),t(".modal.show").find(".btn-close").click(),t(document).trigger("workflowReady"),display_toast("success",e.toast_header_title,e.toast_body_title,t("#joinotify-automations-builder"))):display_toast("error",e.toast_header_title,e.toast_body_title,t("#joinotify-automations-builder"))}catch(t){console.log(t)}},complete:function(){i.prop("disabled",!1).html(s)}})}))})),jQuery(document).on("workflowReady",(function(){CodeMirror.fromTextArea(document.getElementById("joinotify_set_snippet_php"),{mode:"application/x-httpd-php",theme:"dracula",lineNumbers:!0,styleActiveLine:!0,matchBrackets:!0,autoCloseBrackets:!0,indentUnit:4,tabSize:4});setTimeout((function(){t(".joinotify-code-editor").siblings(".CodeMirror").after('<div class="joinotify-resize-code-area">\n\t\t\t\t<svg class="icon-sm icon-dark opacity-75" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 6h16v2H4zm0 5h16v2H4zm0 5h16v2H4z"></path></svg>\n\t\t\t</div>'),t(".joinotify-resize-code-area").each((function(){let e=!1,o=0,i=0,a=t(this).siblings(".CodeMirror");function n(t){if(!e)return;let n=t.clientY-o,s=i+n;s<100&&(s=100),a.css("height",s+"px"),a.find(".CodeMirror-scroll").css("height",s+"px")}function s(){e=!1,t(document).off("mousemove",n),t(document).off("mouseup",s)}0!==a.length?t(this).on("mousedown",(function(d){d.preventDefault(),e=!0,o=d.clientY,i=a.outerHeight(),t(document).on("mousemove",n),t(document).on("mouseup",s)})):console.warn("Code area not found")}))}),500)}))}(jQuery);