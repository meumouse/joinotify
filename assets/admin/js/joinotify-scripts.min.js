!function(t){"use strict";jQuery(document).ready((function(t){let e=window.location.hash,o=localStorage.getItem("joinotify_get_admin_tab_index");if(e){let o=t('.joinotify-wrapper a.nav-tab[href="'+e+'"]');o.length&&o.click()}else null!==o?t(".joinotify-wrapper a.nav-tab").eq(o).click():t('.joinotify-wrapper a.nav-tab[href="#general"]').click()})),t(document).on("click",".joinotify-wrapper a.nav-tab",(function(){let e=t(this).index();localStorage.setItem("joinotify_get_admin_tab_index",e);let o=t(this).attr("href");return t(".joinotify-wrapper a.nav-tab").removeClass("nav-tab-active"),t(".joinotify-form .nav-content").removeClass("active"),t(this).addClass("nav-tab-active"),t(".joinotify-form").find(o).addClass("active"),!1})),jQuery(document).ready((function(t){t(document).on("click",".hide-toast",(function(){var e=t(".toast.show").attr("id");setTimeout((function(){t("#"+e).fadeOut("fast")}),3e3),setTimeout((function(){t("#"+e).remove()}),3500)}))})),jQuery(document).ready((function(t){let e=t('form[name="joinotify-options-form"]'),o=e.serialize();var n;t("#joinotify_save_options").on("click",(function(i){i.preventDefault();let s=t(this),a=s.html(),r=s.width(),_=s.height();s.width(r),s.height(_),t.ajax({url:joinotify_params.ajax_url,type:"POST",data:{action:"joinotify_save_options",form_data:e.serialize()},beforeSend:function(){s.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(i){joinotify_params.debug_mode&&console.log(i);try{"success"===i.status&&(o=e.serialize(),display_toast("success",i.toast_header_title,i.toast_body_title,t(".joinotify-wrapper")),n&&clearTimeout(n),n=setTimeout((function(){t(".toast-save-options").fadeOut("fast",(function(){t(".toast-save-options").remove()}))}),3e3))}catch(t){console.log(t)}},error:function(t,e,o){console.error("AJAX Error:",e,o)},complete:function(){s.html(a)}})})),e.on("change input","input, select, textarea",(function(){e.serialize()!==o?t("#joinotify_save_options").prop("disabled",!1):t("#joinotify_save_options").prop("disabled",!0)}))})),jQuery(document).ready((function(t){display_popup(t("#joinotify_reset_settings_trigger"),t("#joinotify_reset_settings_container"),t("#joinotify_reset_settings_close")),display_popup(t("#joinotify_add_new_phone_trigger"),t("#joinotify_add_new_phone_container"),t("#joinotify_add_new_phone_close")),display_popup(t("#joinotify_send_message_test_trigger"),t("#joinotify_send_message_test_container"),t("#joinotify_send_message_test_close"))})),jQuery(document).ready((function(t){function e(){var e=t(".validate-otp-code").data("phone"),o="";t(".otp-input-item").each((function(){o+=t(this).val()})),t.ajax({url:joinotify_params.ajax_url,method:"POST",data:{action:"joinotify_validate_otp",phone:e,otp:o},beforeSend:function(){t(".validate-otp-code").prepend('<div class="validating-otp-loader"><span class="spinner-border"></span></div>')},success:function(e){joinotify_params.debug_mode&&console.log(e),"success"===e.status?(t("#joinotify_current_phones_senders").html(e.current_phone_senders),t("#joinotify_add_new_phone_container").removeClass("show"),display_toast("success",e.toast_header_title,e.toast_body_title,t(".joinotify-wrapper"))):display_toast("error",e.toast_header_title,e.toast_body_title,t(".joinotify-wrapper"))},error:function(t,e,o){console.error("Error on OTP validation request:",t.responseText)}})}t(document).on("click","#joinotify_add_new_phone_trigger",(function(){t.ajax({url:joinotify_params.ajax_url,method:"POST",data:{action:"joinotify_get_phone_numbers"},beforeSend:function(){t("#joinotify_add_new_phone_container").find(".joinotify-popup-body").html('<div class="placeholder-content" style="width: 100%; height: 5rem;"></div>')},success:function(e){joinotify_params.debug_mode&&console.log(e);try{"success"===e.status&&(e.empty_phone_message?t("#joinotify_add_new_phone_container").find(".joinotify-popup-body").html('<div class="alert alert-info">'+e.empty_phone_message+"</div>"):e.phone_numbers_html&&t("#joinotify_add_new_phone_container").find(".joinotify-popup-body").html(e.phone_numbers_html))}catch(t){console.log(t)}},error:function(t,e,o){console.error("Error on AJAX request:",t.responseText)}})})),t(document).on("click",".register-sender, .request-new-otp",(function(o){o.preventDefault();var n=t(this),i=n.width(),s=n.height(),a=n.html(),r=n.data("phone");n.width(i),n.height(s),t.ajax({url:joinotify_params.ajax_url,method:"POST",data:{action:"joinotify_register_phone_sender",phone:r},beforeSend:function(){n.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(o){joinotify_params.debug_mode&&console.log(o);try{"success"===o.status?(t("#joinotify_add_new_phone_container").find(".joinotify-popup-body").html(o.otp_input_component),function(){var e=t(".countdown-otp-resend"),o=t(".validate-otp-code").data("phone"),n=60;e.text(n);var i=setInterval((function(){n--,e.text(n),n<=0&&(clearInterval(i),t("#joinotify_add_new_phone_container").find(".resend-otp").html('<button class="btn btn-sm btn-outline-primary request-new-otp" data-phone="'+o+'">'+joinotify_params.resend_otp_button+"</button>"))}),1e3)}(),t(".otp-input-item").on("input",(function(){var o=t(this);1===o.val().length&&o.next(".otp-input-item").focus(),0===t(".otp-input-item").filter((function(){return""===t(this).val()})).length&&e()})),t(".otp-input-item").on("paste",(function(o){var n=o.originalEvent.clipboardData.getData("text");4===n.length&&t.isNumeric(n)&&(t(".otp-input-item").each((function(e){t(this).val(n[e])})),e())}))):display_toast("error",o.toast_header_title,o.toast_body_title,t(".joinotify-wrapper"))}catch(t){console.log(t)}},error:function(t,e,o){console.error("Error on AJAX request:",t.responseText)},complete:function(){n.prop("disabled",!1).html(a)}})}))})),jQuery(document).ready((function(t){t(document).on("click",".remove-phone-sender",(function(e){if(e.preventDefault(),confirm(joinotify_params.confirm_remove_sender)){var o=t(this),n=o.width(),i=o.height(),s=o.html(),a=o.data("phone");o.width(n),o.height(i),t.ajax({url:joinotify_params.ajax_url,method:"POST",data:{action:"joinotify_remove_phone_sender",phone:a},beforeSend:function(){o.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(e){joinotify_params.debug_mode&&console.log(e);try{"success"===e.status?(t("#joinotify_current_phones_senders").find(".joinotify-phone-list").html(e.updated_list_html),display_toast("success",e.toast_header_title,e.toast_body_title,t(".joinotify-wrapper"))):display_toast("error",e.toast_header_title,e.toast_body_title,t(".joinotify-wrapper"))}catch(t){console.log(t)}},error:function(t,e,o){console.error("Error on AJAX request:",t.responseText)},complete:function(){o.prop("disabled",!1).html(s)}})}}))})),jQuery(document).ready((function(t){t(document).on("click","#confirm_reset_settings",(function(e){e.preventDefault();let o=t(this),n=o.html(),i=o.width(),s=o.height();o.width(i),o.height(s),t.ajax({url:joinotify_params.ajax_url,type:"POST",data:{action:"joinotify_reset_plugin_action"},beforeSend:function(){o.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(e){try{"success"===e.status?(t("#joinotify_reset_settings_container").removeClass("show"),display_toast("success",e.toast_header_title,e.toast_body_title,t(".joinotify-wrapper"))):display_toast("error",e.toast_header_title,e.toast_body_title,t(".joinotify-wrapper"))}catch(t){console.log(t)}},error:function(t,e,o){console.error("Error on AJAX request:",t.responseText)},complete:function(){o.prop("disabled",!1).html(n)}})}))})),jQuery(document).ready((function(t){var e=t("#joinotify_get_phone_receive_test"),o=t("#joinotify_get_test_message");t(document).on("change input keyup",t(e,o),(function(){""!==t(e).val()&&""!==t(o).val()?t("#joinotify_send_test_message").prop("disabled",!1):t("#joinotify_send_test_message").prop("disabled",!0)})),t(document).on("click","#joinotify_send_test_message",(function(n){n.preventDefault();let i=t(this),s=i.html(),a=i.width(),r=i.height();i.width(a),i.height(r),t.ajax({url:joinotify_params.ajax_url,method:"POST",data:{action:"joinotify_send_message_test",sender:t("#joinotify_select_sender_test").val(),receiver:t(e).val(),message:t(o).val()},beforeSend:function(){i.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(e){joinotify_params.debug_mode&&console.log(e);try{"success"===e.status?(t(o).val("").change(),t("#joinotify_send_message_test_container").removeClass("show"),display_toast("success",e.toast_header_title,e.toast_body_title,t(".joinotify-wrapper"))):display_toast("error",e.toast_header_title,e.toast_body_title,t(".joinotify-wrapper"))}catch(t){console.log(t)}},error:function(t,e,o){console.error("Error on AJAX request:",t.responseText)},complete:function(){i.prop("disabled",!1).html(s)}})}))})),jQuery(document).ready((function(t){visibility_controller(t("#enable_proxy_api"),t(".require-proxy-api")),display_popup(t("#proxy_api_settings_trigger"),t("#proxy_api_settings_container"),t("#proxy_api_settings_close")),t("#joinotify_generate_proxy_api_key").on("click",(function(e){e.preventDefault();const o=function(t){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let o="";for(let n=0;n<t;n++)o+=e.charAt(Math.floor(62*Math.random()));return o}(32);t("#proxy_api_key").val(o).change()}))})),jQuery(document).ready((function(t){visibility_controller(t("#enable_debug_mode"),t(".require-debug-mode")),display_popup(t("#joinotify_get_debug_details_trigger"),t("#joinotify_get_debug_details_container"),t("#joinotify_get_debug_details_close")),t("#joinotify_get_debug_details_trigger").on("click",(function(e){e.preventDefault(),t.ajax({url:joinotify_params.ajax_url,method:"POST",data:{action:"joinotify_get_debug_logs"},success:function(e){joinotify_params.debug_mode&&console.log(e);try{"success"===e.status?(t("#joinotify_get_debug_details_container").find(".joinotify-popup-body").html(e.log_content),t("#joinotify_clear_log_file").prop("disabled",!1),t("#joinotify_download_log_file").prop("disabled",!1)):(t("#joinotify_get_debug_details_container").find(".joinotify-popup-body").html(`<div class="alert alert-info">${e.toast_body_title}</div>`),display_toast("warning",e.toast_header_title,e.toast_body_title,t(".joinotify-wrapper")))}catch(t){console.log(t)}},error:function(t,e,o){console.error("Error on AJAX request:",t.responseText)}})})),t("#joinotify_get_debug_details_container").on("click",(function(e){e.target===this&&(t("#joinotify_get_debug_details_container").find(".joinotify-popup-body").html('<div class="placeholder-content" style="width: 100%; height: 10rem;"></div>'),t("#joinotify_clear_log_file").prop("disabled",!0),t("#joinotify_download_log_file").prop("disabled",!0))})),t("#joinotify_clear_log_file").on("click",(function(e){if(e.preventDefault(),confirm(joinotify_params.confirm_clear_debug_logs)){var o=t(this),n=o.width(),i=o.height(),s=o.html();o.width(n),o.height(i),t.ajax({url:joinotify_params.ajax_url,method:"POST",data:{action:"joinotify_clear_debug_logs"},beforeSend:function(){o.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(e){joinotify_params.debug_mode&&console.log(e);try{"success"===e.status?(t("#joinotify_get_debug_details_container").removeClass("show").find(".joinotify-popup-body").html('<div class="placeholder-content" style="width: 100%; height: 10rem;"></div>'),display_toast("success",e.toast_header_title,e.toast_body_title,t(".joinotify-wrapper"))):display_toast("error",e.toast_header_title,e.toast_body_title,t(".joinotify-wrapper"))}catch(t){console.log(t)}},error:function(t,e,o){console.error("Error on AJAX request:",t.responseText)},complete:function(){o.prop("disabled",!1).html(s)}})}})),t("#joinotify_download_log_file").on("click",(function(e){e.preventDefault();var o=t(this),n=o.width(),i=o.height(),s=o.html();o.width(n),o.height(i),t.ajax({url:joinotify_params.ajax_url,method:"POST",data:{action:"joinotify_download_debug_logs"},beforeSend:function(){o.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(e){joinotify_params.debug_mode&&console.log(e);try{if("success"===e.status){t("#joinotify_get_debug_details_container").removeClass("show"),display_toast("success",e.toast_header_title,e.toast_body_title,t(".joinotify-wrapper"));const o=e.download_url,n=document.createElement("a");n.href=o,n.download="joinotify-debug-logs.txt",document.body.appendChild(n),n.click(),document.body.removeChild(n)}else display_toast("error",e.toast_header_title,e.toast_body_title,t(".joinotify-wrapper"))}catch(t){console.log(t)}},error:function(t,e,o){console.error("Error on AJAX request:",t.responseText)},complete:function(){o.prop("disabled",!1).html(s)}})}))})),jQuery(document).ready((function(e){display_popup(t("#woocommerce_settings_trigger"),t("#woocommerce_settings_container"),t("#woocommerce_settings_container"))}))}(jQuery);