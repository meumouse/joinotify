!function(t){"use strict";var e=joinotify_license_params;const s={displayToast:function(s,o,a){let i="",n="",l="";"success"===s?(i="toast-success",n="bg-success text-white",l='<svg class="icon icon-white me-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"></path><path d="M9.999 13.587 7.7 11.292l-1.412 1.416 3.713 3.705 6.706-6.706-1.414-1.414z"></path></svg>'):"error"===s?(i="toast-danger",n="bg-danger text-white",l='<svg class="icon icon-white me-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"></path><path d="M11 11h2v6h-2zm0-4h2v2h-2z"></path></svg>'):(i="toast-secondary",n="bg-secondary text-white",l="");const c="toast-"+Math.random().toString(36).substr(2,9),r=`<div id="${c}" class="toast ${i} show">\n\t\t\t\t\t<div class="toast-header ${n}">\n\t\t\t\t\t\t${l}\n\t\t\t\t\t\t<span class="me-auto">${o}</span>\n\t\t\t\t\t\t<button class="btn-close btn-close-white ms-2 hide-toast" type="button" data-bs-dismiss="toast" aria-label="${e.arial_label_toasts}"></button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="toast-body">${a}</div>\n\t\t\t</div>`;t("#joinotify_license_area").prepend(r),setTimeout((function(){t("#"+c).fadeOut("fast")}),3e3),setTimeout((function(){t("#"+c).remove()}),3500)},activateLicense:function(){t("#joinotify_active_license").on("click",(function(o){o.preventDefault();const a=t(this),i=a.width(),n=a.height(),l=a.html(),c=t("#joinotify_license_key").val();a.width(i),a.height(n),t.ajax({url:e.ajax_url,method:"POST",data:{action:"joinotify_active_license",license_key:c},beforeSend:function(){a.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(t){try{"success"===t.status?(s.displayToast("success",t.toast_header_title,t.toast_body_title),setTimeout((function(){location.reload()}),1e3)):s.displayToast("error",t.toast_header_title,t.toast_body_title)}catch(t){console.log(t)}},complete:function(){a.prop("disabled",!1).html(l)},error:function(t,e,s){alert("AJAX error: "+s)}})}))},deactivateLicense:function(){t("#joinotify_deactive_license").on("click",(function(o){if(o.preventDefault(),!confirm(e.confirm_deactivate_license))return;const a=t(this),i=a.width(),n=a.height(),l=a.html();a.width(i),a.height(n),t.ajax({url:e.ajax_url,method:"POST",data:{action:"joinotify_deactive_license"},beforeSend:function(){a.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(t){try{"success"===t.status?(s.displayToast("success",t.toast_header_title,t.toast_body_title),setTimeout((function(){location.reload()}),1e3)):s.displayToast("error",t.toast_header_title,t.toast_body_title)}catch(t){console.log(t)}},complete:function(){a.prop("disabled",!1).html(l)},error:function(t,e,s){alert("AJAX error: "+s)}})}))},alternativeActivation:function(){t("#license_key_zone").on("dragover dragleave",(function(e){e.preventDefault(),t(this).toggleClass("drag-over","dragover"===e.type)})),t("#license_key_zone").on("drop",(function(e){e.preventDefault();const o=e.originalEvent.dataTransfer.files[0];t(this).hasClass("file-uploaded")||s.handleFile(o,t(this))})),t("#upload_license_key").on("change",(function(e){const o=e.target.files[0];s.handleFile(o,t(this).parents(".dropzone-license"))}))},handleFile:function(o,a){if(o){const i=o.name,n=new FormData;n.append("action","joinotify_alternative_activation_license"),n.append("file",o),a.children(".file-list").removeClass("d-none").text(i),a.addClass("file-processing"),a.append('<div class="spinner-border"></div>'),t.ajax({url:e.ajax_url,type:"POST",data:n,processData:!1,contentType:!1,success:function(t){e.debug_mode&&console.log(t);try{"success"===t.status?(s.displayToast("success",t.toast_header_title,t.toast_body_title),a.addClass("file-uploaded").removeClass("file-processing"),a.children(".spinner-border").remove(),a.append('<div class="upload-notice d-flex flex-column align-items-center"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="#22c55e" d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"></path><path fill="#22c55e" d="M9.999 13.587 7.7 11.292l-1.412 1.416 3.713 3.705 6.706-6.706-1.414-1.414z"></path></svg><span>'+t.dropfile_message+"</span></div>"),a.children(".file-list").addClass("d-none"),setTimeout((function(){location.reload()}),1e3)):(s.displayToast("error",t.toast_header_title,t.toast_body_title),a.addClass("invalid-file").removeClass("drag-over file-processing"),a.children(".spinner-border").remove(),a.children(".drag-text").removeClass("d-none"),a.children(".drag-and-drop-file").removeClass("d-none"),a.children(".upload-license-key").removeClass("d-none"),a.children(".file-list").addClass("d-none"))}catch(t){console.log(t)}},error:function(t,e,s){a.addClass("fail-upload").removeClass("file-processing"),console.log("Error on upload file"),console.log(t.responseText)}})}},init:function(){this.activateLicense(),this.deactivateLicense(),this.alternativeActivation()}};t(document).ready((function(){s.init()}))}(jQuery);